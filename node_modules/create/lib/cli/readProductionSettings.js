import * as fs from "node:fs/promises";
import path from "node:path";
import { tryCatchSafe } from "../utils/tryCatch.js";
export async function readProductionSettings({ directory = ".", mode, } = {}) {
    const items = await tryCatchSafe(fs.readdir(directory));
    let defaultMode = mode ?? "initialize";
    if (!items) {
        return defaultMode === "migrate"
            ? new Error("Cannot run with --mode migrate on a directory that does not yet exist.")
            : { mode: defaultMode };
    }
    for (const item of items) {
        if (/create\.config\.\w+/.test(item)) {
            return {
                configFile: path.join(directory, item),
                mode: "migrate",
            };
        }
        if (item === ".git" && mode !== "initialize") {
            defaultMode = "migrate";
        }
    }
    return {
        mode: defaultMode,
    };
}
//# sourceMappingURL=readProductionSettings.js.map